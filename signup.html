<!doctype html>
<html lang="en">
  <head>
    <title>Sign Up - owntheSTREETS</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body class="bg-black text-gray-900 flex flex-col min-h-screen">
    <!-- Announcement Bar -->
    <div class="bg-black border-b border-gray-800 overflow-hidden">
      <!-- Same announcement as login/index -->
      <div
        class="announcement-slide whitespace-nowrap py-2 text-center text-sm font-bold text-white"
      >
        <span class="inline-block px-8">FREE SHIPPING ON ORDERS $50+</span>
        <span class="inline-block px-8">|</span>
        <span class="inline-block px-8">HOLIDAY SALE - UP TO 40% OFF</span>
      </div>
    </div>

    <!-- Navigation -->
    <nav
      id="navbar"
      class="sticky top-0 z-50 bg-black text-white transition-all duration-300"
    >
      <div class="container mx-auto px-4">
        <div class="flex items-center justify-between gap-3 py-3 sm:py-4">
          <!-- Logo -->
          <div class="flex items-center min-w-0">
            <a
              href="index.html"
              class="text-lg sm:text-xl md:text-2xl lg:text-3xl font-black tracking-tight truncate"
            >
              owntheSTREETS
            </a>
          </div>

          <!-- Desktop Navigation -->
          <div class="hidden lg:flex items-center space-x-8">
            <!-- Navigation Links Removed for Signup Page -->
          </div>
        </div>
      </div>
    </nav>

    <!-- Signup Section -->
    <section
      class="flex-grow flex items-center justify-center bg-black text-white py-20 px-4"
    >
      <div class="w-full max-w-md space-y-8">
        <div class="text-center">
          <h2 class="text-3xl font-black tracking-tight">CREATE ACCOUNT</h2>
          <p class="mt-2 text-sm text-gray-400">Join the movement</p>
        </div>

        <form class="mt-8 space-y-6" id="signup-form">
          <div class="space-y-4">
            <div>
              <label for="name" class="sr-only">Full Name</label>
              <input
                id="name"
                name="name"
                type="text"
                autocomplete="name"
                required
                class="appearance-none rounded-none relative block w-full px-3 py-3 border border-gray-700 bg-gray-900 placeholder-gray-500 text-white focus:outline-none focus:ring-white focus:border-white focus:z-10 sm:text-sm"
                placeholder="Full Name"
              />
            </div>
            <div>
              <label for="email" class="sr-only">Email address</label>
              <input
                id="email"
                name="email"
                type="email"
                autocomplete="email"
                required
                class="appearance-none rounded-none relative block w-full px-3 py-3 border border-gray-700 bg-gray-900 placeholder-gray-500 text-white focus:outline-none focus:ring-white focus:border-white focus:z-10 sm:text-sm"
                placeholder="Email address"
              />
            </div>
            <div class="relative">
              <label for="password" class="sr-only">Password</label>
              <input
                id="password"
                name="password"
                type="password"
                autocomplete="new-password"
                required
                class="appearance-none rounded-none relative block w-full px-3 py-3 border border-gray-700 bg-gray-900 placeholder-gray-500 text-white focus:outline-none focus:ring-white focus:border-white focus:z-10 sm:text-sm pr-10"
                placeholder="Password"
              />
              <button
                type="button"
                id="toggle-password"
                class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white"
              >
                <i class="fas fa-eye"></i>
              </button>
            </div>
            <div class="relative">
              <label for="confirm-password" class="sr-only"
                >Confirm Password</label
              >
              <input
                id="confirm-password"
                name="confirm-password"
                type="password"
                autocomplete="new-password"
                required
                class="appearance-none rounded-none relative block w-full px-3 py-3 border border-gray-700 bg-gray-900 placeholder-gray-500 text-white focus:outline-none focus:ring-white focus:border-white focus:z-10 sm:text-sm pr-10"
                placeholder="Confirm Password"
              />
              <button
                type="button"
                id="toggle-confirm-password"
                class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white"
              >
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </div>

          <!-- Password Strength -->
          <div>
            <div class="h-1 w-full bg-gray-800 rounded overflow-hidden">
              <div
                id="password-strength-bar"
                class="h-full bg-red-500 w-0 transition-all duration-300"
              ></div>
            </div>
            <p id="password-strength-text" class="text-xs text-gray-500 mt-1">
              Password strength
            </p>
          </div>

          <!-- Terms -->
          <div class="flex items-center">
            <input
              id="terms"
              name="terms"
              type="checkbox"
              required
              class="h-4 w-4 text-white focus:ring-white border-gray-600 rounded bg-gray-900"
            />
            <label for="terms" class="ml-2 block text-sm text-gray-400">
              I agree to the
              <a href="#" class="text-white hover:underline"
                >Terms of Service</a
              >
              and
              <a href="#" class="text-white hover:underline">Privacy Policy</a>
            </label>
          </div>

          <div>
            <button
              type="submit"
              class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-bold rounded-full text-black bg-white hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-white transition-colors"
            >
              CREATE ACCOUNT
            </button>
          </div>

          <div
            id="signup-error"
            class="text-red-500 text-sm text-center hidden"
          ></div>
        </form>

        <div class="text-center text-sm text-gray-400">
          Already have an account?
          <a
            href="login.html"
            class="font-medium text-white hover:underline underline-offset-4"
            >Sign in</a
          >
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black text-white py-12 border-t border-gray-800">
      <div class="container mx-auto px-4 text-center text-gray-400 text-sm">
        <p>Â© 2024 owntheSTREETS Co., LLC. All Rights Reserved.</p>
      </div>
    </footer>

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js"></script>
    <script src="js/supabase-client.js"></script>
    <script src="js/utils.js"></script>
    <script>
      function setupPasswordToggle(toggleId, inputId) {
        document
          .getElementById(toggleId)
          .addEventListener("click", function () {
            const input = document.getElementById(inputId);
            const icon = this.querySelector("i");

            if (input.type === "password") {
              input.type = "text";
              icon.classList.remove("fa-eye");
              icon.classList.add("fa-eye-slash");
            } else {
              input.type = "password";
              icon.classList.remove("fa-eye-slash");
              icon.classList.add("fa-eye");
            }
          });
      }

      setupPasswordToggle("toggle-password", "password");
      setupPasswordToggle("toggle-confirm-password", "confirm-password");

      document
        .getElementById("password")
        .addEventListener("input", function (e) {
          const val = e.target.value;
          const bar = document.getElementById("password-strength-bar");
          const text = document.getElementById("password-strength-text");
          let strength = 0;

          if (val.length > 5) strength += 20;
          if (val.length > 8) strength += 20;
          if (/[A-Z]/.test(val)) strength += 20;
          if (/[0-9]/.test(val)) strength += 20;
          if (/[^A-Za-z0-9]/.test(val)) strength += 20;

          bar.style.width = strength + "%";
          if (strength < 40) {
            bar.className = "h-full bg-red-500 w-0 transition-all duration-300";
            text.textContent = "Weak";
          } else if (strength < 80) {
            bar.className =
              "h-full bg-yellow-500 w-0 transition-all duration-300";
            text.textContent = "Medium";
          } else {
            bar.className =
              "h-full bg-green-500 w-0 transition-all duration-300";
            text.textContent = "Strong";
          }
        });

      document
        .getElementById("signup-form")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const name = document.getElementById("name").value;
          const email = document.getElementById("email").value;
          const password = document.getElementById("password").value;
          const confirmPassword =
            document.getElementById("confirm-password").value;
          const terms = document.getElementById("terms").checked;

          if (!terms) {
            const errorEl = document.getElementById("signup-error");
            errorEl.textContent = "You must agree to the Terms of Service.";
            errorEl.classList.remove("hidden");
            return;
          }

          if (password !== confirmPassword) {
            const errorEl = document.getElementById("signup-error");
            errorEl.textContent = "Passwords do not match";
            errorEl.classList.remove("hidden");
            return;
          }

          const result = await Auth.signup(name, email, password);

          if (result.success) {
            window.location.href = "profile.html";
          } else {
            const errorEl = document.getElementById("signup-error");
            errorEl.textContent = result.message;
            errorEl.classList.remove("hidden");
          }
        });
    </script>
  </body>
</html>
